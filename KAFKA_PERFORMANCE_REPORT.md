# Kafka 성능 테스트 보고서

## 📊 테스트 환경
- **서버**: EC2 t2.xlarge (4 vCPU, 16GB RAM)
- **Kafka**: Confluent Platform (Docker)
- **테스트 일시**: 2025-08-17 02:11 UTC

## 🚀 성능 측정 결과

### 1. 처리량 (Throughput)
| 메트릭 | 측정값 | 평가 |
|--------|--------|------|
| **최대 처리량** | **86,602 msgs/sec** | 🟢 우수 |
| **데이터 처리량** | 84.57 MB/sec | 🟢 우수 |
| **100만 메시지 처리 시간** | 13초 | 🟢 우수 |

### 2. 지연시간 (Latency)
| 백분위 | 측정값 | 평가 |
|--------|--------|------|
| **평균** | 8.60ms | 🟢 우수 |
| **P50 (중앙값)** | 3ms | 🟢 매우 우수 |
| **P95** | 40ms | 🟢 우수 |
| **P99** | 79ms | 🟢 우수 |
| **P99.9** | 142ms | 🟡 양호 |
| **최대** | 420ms | 🟡 양호 |

### 3. 제한된 처리량 테스트 (10K msgs/sec)
| 메트릭 | 측정값 | 설명 |
|--------|--------|------|
| **실제 처리량** | 9,992 msgs/sec | 목표 달성 |
| **평균 지연** | 102.71ms | 처리량 제한 시 |
| **P99 지연** | 574ms | 배치 처리 영향 |

## 📈 성능 분석

### 강점
1. **높은 처리량**: 86K msgs/sec는 대부분의 실시간 애플리케이션에 충분
2. **낮은 지연시간**: P50 3ms, P95 40ms로 실시간 처리 적합
3. **안정적 성능**: 지속적인 부하에서도 일관된 성능

### 개선 가능 영역
1. **Consumer 성능**: 현재 Consumer 테스트가 타임아웃
2. **동시성 처리**: 멀티 Producer 시나리오 최적화 필요
3. **P99.9 지연시간**: 142ms는 개선 여지 있음

## 🎯 권장사항

### 즉시 적용 가능
```bash
# 1. 파티션 증가 (처리량 향상)
docker exec kafka kafka-topics --bootstrap-server localhost:9092 \
    --alter --topic your-topic --partitions 12

# 2. Producer 설정 최적화
batch.size=32768        # 현재 16384 → 32768
linger.ms=5             # 현재 10 → 5
compression.type=snappy # lz4보다 빠른 압축
```

### 중기 개선
1. **Consumer Group 스케일링**: 파티션 수만큼 Consumer 인스턴스
2. **Replication Factor**: 프로덕션에서는 3 권장
3. **모니터링**: Prometheus + Grafana 구성

## 📊 타 시스템 대비 성능

| 시스템 | 처리량 | 평균 지연 | 비고 |
|--------|--------|-----------|------|
| **현재 Kafka** | 86K msgs/sec | 8.6ms | Docker 환경 |
| RabbitMQ (일반) | 20-40K msgs/sec | 5-10ms | 단일 노드 |
| Redis Pub/Sub | 100K+ msgs/sec | 1-5ms | 비영속성 |
| AWS Kinesis | 1K-10K msgs/sec | 200ms | 관리형 서비스 |

## 📝 결론

현재 Kafka 설정은 **프로덕션 사용에 충분한 성능**을 보여주고 있습니다.

- ✅ IoT 센서 데이터 수집
- ✅ 실시간 로그 처리
- ✅ 이벤트 스트리밍
- ✅ 마이크로서비스 통신

추가 최적화 없이도 **초당 8만 메시지 처리**가 가능하며, 
평균 **8.6ms의 낮은 지연시간**으로 실시간 처리에 적합합니다.

---
*테스트 도구: kafka-performance-test.sh*  
*환경: Docker Compose on EC2*