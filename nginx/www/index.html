<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MQTT 실시간 모니터링 시스템</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🚀 실시간 IoT 모니터링 대시보드</h1>
            <div class="status-bar">
                <span class="status-item">
                    <span class="status-dot" id="ws-status"></span>
                    WebSocket
                </span>
                <span class="status-item">
                    <span class="status-dot" id="mqtt-status"></span>
                    MQTT
                </span>
                <span class="timestamp" id="current-time"></span>
            </div>
        </header>

        <div class="dashboard">
            <!-- 시스템 서비스 상태 -->
            <section class="card">
                <h2>📊 서비스 상태</h2>
                <div class="services-grid">
                    <div class="service-card" id="ws-service">
                        <div class="service-icon">🌐</div>
                        <h3>WebSocket Server</h3>
                        <p class="service-port">Port: 8081 (SockJS)</p>
                        <div class="service-status checking">확인중...</div>
                        <button onclick="testWebSocket()">연결</button>
                    </div>
                    <div class="service-card" id="mqtt-service">
                        <div class="service-icon">📡</div>
                        <h3>MQTT Broker</h3>
                        <p class="service-port">Port: 3123</p>
                        <div class="service-status checking">확인중...</div>
                        <button onclick="testMQTT()">테스트</button>
                    </div>
                </div>
            </section>

            <!-- 실시간 좌표 데이터 -->
            <section class="card">
                <h2>📍 실시간 좌표 데이터 (ORIN: 1420524217000)</h2>
                <div class="coordinate-display">
                    <div class="coord-item">
                        <label>X 좌표:</label>
                        <span id="coord-x">-</span>
                    </div>
                    <div class="coord-item">
                        <label>Y 좌표:</label>
                        <span id="coord-y">-</span>
                    </div>
                    <div class="coord-item">
                        <label>타임스탬프:</label>
                        <span id="coord-timestamp">-</span>
                    </div>
                </div>
                <canvas id="coordinate-chart"></canvas>
            </section>

            <!-- MQTT 명령 전송 -->
            <section class="card">
                <h2>🎮 MQTT 명령 전송</h2>
                <div class="mqtt-command">
                    <div class="command-form">
                        <div class="form-group">
                            <label for="orin-id">ORIN ID:</label>
                            <input type="text" id="orin-id" value="1420524217000" placeholder="ORIN ID 입력">
                        </div>
                        <div class="form-group">
                            <label for="mqtt-command">명령:</label>
                            <input type="text" id="mqtt-command" placeholder="전송할 명령 입력 (예: STOP, START, STATUS)">
                            <small style="color: #94a3b8; font-size: 0.8rem; margin-top: 4px;">JSON 형식: {"command": "your_command"}</small>
                        </div>
                        <button onclick="sendMQTTCommand()" class="btn-primary">명령 전송</button>
                    </div>
                    <div id="mqtt-response" class="mqtt-response"></div>
                </div>
            </section>


            <!-- API 엔드포인트 목록 -->
            <section class="card">
                <h2>🔌 API 엔드포인트</h2>
                <div class="api-endpoints">
                    <div class="endpoint-group">
                        <h4>WebSocket & MQTT</h4>
                        <ul>
                            <li><code>WS /coordinates</code> - 좌표 스트림 (SockJS)</li>
                            <li><code>POST /api/mqtt/commands/{orinId}</code> - MQTT 명령 전송</li>
                            <li><code>TCP :3123</code> - MQTT Broker 직접 연결</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 시스템 로그 -->
            <section class="card">
                <h2>📜 실시간 로그</h2>
                <div class="log-container" id="log-container">
                    <div class="log-entry info">시스템 시작됨...</div>
                </div>
                <div class="log-controls">
                    <button onclick="clearLogs()">로그 지우기</button>
                    <label>
                        <input type="checkbox" id="auto-scroll" checked> 자동 스크롤
                    </label>
                </div>
            </section>
        </div>

        <footer>
            <p>© 2024 MQTT Real-time Monitoring System | <a href="https://github.com/your-repo" target="_blank">GitHub</a></p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="app.js"></script>
</body>
</html>